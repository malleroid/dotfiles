# \~/.claude/CLAUDE.md

## Security & Compliance 🛡️

### 🚫 Commit 禁止パターン

- `*.pem`
- `*.key`
- `*.env` / `.env.*`
- `config/credentials.yml.enc`
- `*secrets*`
- `*.p12`
- `id_rsa*` / `id_ed25519*`

> Claude はこれらに一致するファイルを **生成・追加・表示・共有しないこと**。

### ⛔ シェル操作の範囲制限

- Claude が実行するシェルコマンドは **現在の作業ディレクトリ（= このリポジトリ）内** に限定すること。
- リポジトリ外のファイル・ディレクトリを作成／変更／削除／移動する操作は禁止。
- `curl` / `wget` など外部リクエストを発行するコマンドは事前確認なしに実行しない。

### その他原則

1. 社外秘コード・個人情報を含むファイルは公開リポジトリへ push しない。
2. 会社／OSS／副業などの区分に応じた追加ルールは各リポジトリの CLAUDE.md で定義する。

---

## Shell & Environment 🐟

- すべての端末で **fish shell 5.x** を使用。
- dotfiles により `fish_add_path` 等を設定済み。Claude は fish 前提でコマンドを提示する。

---

## Code Style (Placeholder) ✏️

<!-- 後日、共通スタイルを追加する場合に使用 -->

---

## AI Workflow 🤖

### PR 詳細レビュー自動化

PR レビュー時は以下のプロンプトでブランチの変更内容を構造化して要約・分析する

このブランチで作成されているプルリクエストの内容と差分をチェックし、どのような変更が行われたかまとめてください。
次の観点で整理してください：

- 主な変更内容
- 重大な指摘事項
- 軽微な改善提案
- 変更の影響範囲
- 潜在的なリスク・不確実性
- 人間が最終確認すべき観点

### フィードバックラダー（優先度順）

1. 🚨 **ブロッカー**: マージ前に必須修正（セキュリティ、重大バグ、データ損失リスク）
2. ⚠️ **重要**: 強く推奨される改善（パフォーマンス、設計問題、技術的負債）
3. 💡 **提案**: 検討すべき改善案（可読性、将来の拡張性、リファクタリング）
4. 📝 **nitpick**: 任意の軽微な改善（スタイル、命名、コメント）
5. ✨ **称賛**: 良い実装の認識（学習価値のある箇所、エレガントな解決策）

### レビュー出力フォーマット

- **\[総合評価]**: X/10 点
- **\[概要]**: 変更の目的と全体像
- **\[重大な指摘事項]**: セキュリティ・パフォーマンス・データ品質の問題（-2 ～-3 点/件）
- **\[軽微な改善提案]**: コードスタイル・可読性・保守性の改善（-0.5 ～-1 点/件）
- **\[影響範囲]**: 変更による他システム・ユーザーへの影響
- **\[リスク・不確実性]**: 潜在的な問題・テスト観点
- **\[人間が最終確認すべき観点]**: AI では判断困難な業務ロジック・設計判断

---

## Repository-Specific Overrides (例示) 📝

```markdown
## If repo includes "github.com/your-company/"

# - default branch: main

# - branch naming: feature/JIRA-123-description

# - CI: GitHub Actions, secrets via OIDC
```

---

## メンテナンス指針

- dotfiles 更新時にこのファイルも点検し、不要行を削除・新規禁止パターンを追加。
- ファイルサイズは **50 KB 未満** を目安に維持。大きくなる場合は各リポジトリ側へ移動。
